# Module: netflow
# Docs: https://www.elastic.co/guide/en/beats/filebeat/7.x/filebeat-module-netflow.html

- module: netflow
  log:
    enabled: true
    var:
      netflow_host: 0.0.0.0
      netflow_port: 2055
      internal_networks:
        - private
  input:
    queue:
      mem:
        events: 4096          # Naikkan buffer mem untuk burst traffic
        flush.min_events: 512
        flush.timeout: 5s

    processors:
      - add_locale:
          format: offset      # Tambahkan info timezone di log
      - add_fields:
          target: ''
          fields:
            timezone: "Asia/Jakarta"
      - script:
          lang: javascript
          file: /etc/filebeat/netflow-mod-ip.js
      - dns:
          type: reverse
          fields:
            source.ip: source.domain
            destination.ip: destination.domain
      - script:
          lang: javascript
          file: /etc/filebeat/netflow-mod-domain.js
